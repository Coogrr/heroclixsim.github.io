<!DOCTYPE html>
<html lang="en" dir="ltr">
  <div>
    <label>Attack Roll Parameters</label>
    <div class="Die Inputs">
        <div>
          <label>Target</label>
          <input type="number" id="targetNumber">
        </div>
        <div>
          <label>Opposing Prob</label>
          <input type="number" id="opposingProbs">
        </div>
        <div>
          <label>Your Prob</label>
          <input type="number" id="yourProbs">
        </div>
    </div>
    <button onclick="simulate()" name="simulate">Perform Simulation</button>
    <div>
      <div>
        <label>Percentage To Hit</label>
        <input type="text" id="percenttohit" readonly="readonly">
      </div>
    </div>
    <label>If it shows 100% it's because I have it set to round to 2 decimal places, read as above 99%. Percents are off by an average of 0.1% compared to calculated, as far as I can tell the differences between options are almost always large enough this doesn't matter.</label>
  </div>

  <script type="text/javascript">

    averageresult = 0;

    function summingResults(result){
        averageresult+=result;
    }

    var simulate = function(){
    // See https://aka.ms/new-console-template for more information
    dice1 = 0;
    dice2 = 0;
    
    

    successful = 0;
    
    target=document.getElementById("targetNumber").value;
    opposingprob=document.getElementById("opposingProbs").value;
    yourprob=document.getElementById("yourProbs").value;
    
    const results = [];
    
     
    for (k=0; k<5; k++){
    
    for (i=0; i<1000000; i++){
    
    currentopposingprob = opposingprob;
    currentyourprob = yourprob;
    
    
    
    dice1 = Math.floor(Math.random() * 6) + 1;
    dice2 = Math.floor(Math.random() * 6) + 1;
    
    total = dice1 + dice2;
    
    while (currentopposingprob > 0 || currentyourprob > 0) {
    if (total >= target && currentopposingprob > 0){
        dice1 = Math.floor(Math.random() * 6) + 1;
        dice2 = Math.floor(Math.random() * 6) + 1;
    
        total = dice1 + dice2;
        currentopposingprob--;
    }
    else if (total < target && currentyourprob == 0){
        break;
    }
    if (total < target && currentyourprob > 0){
        dice1 = Math.floor(Math.random() * 6) + 1;
        dice2 = Math.floor(Math.random() * 6) + 1;
    
        total = dice1 + dice2;
        currentyourprob--;
    }
    else if (total >= target && currentopposingprob == 0){
        break;
    }
    }
    
    if (total >= target){
        successful++;
    }
    
    }
    
    
    results[k] = successful;
    
    
    
    successful=0;
    }
    console.log("Summing Results")
    results.forEach(summingResults);
    console.log("Results Summed")
    averageresult = averageresult / results.length;
    percentSuccessful = averageresult / 100;
    percentSuccessful = Math.round(percentSuccessful);
    percentSuccessful = percentSuccessful / 100;
    document.getElementById("percenttohit").value = percentSuccessful + "%";
    averageresult=0;
    }
 
    
        

  </script>
</html>